<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Manager</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div id="splashScreen" class="splash-screen">
        <img src="/static/images/logo.png" alt="Logo firmy" class="splash-logo">
    </div>
    <div class="wrapper">
        <!-- Pasek boczny -->
        <div class="sidebar">
            <img src="/static/images/logo.png" alt="Logo firmy" class="logo">
            <button id="mainScreenButton" data-target="homeContent">Ekran G≈Ç√≥wny</button>
            <button id="addDocumentButton" data-target="addDocumentContent">Nowa Polisa</button>
            <button id="addPaymentButton" data-target="addPaymentContent">P≈Çatno≈õci</button>
            <button id="documentInfo" data-target="documentInfoContent">Dane polisy</button>
            <button id="reportKNF" data-target="reportKNFContent">Raport KNF</button>
        </div>

        <!-- G≈Ç√≥wna zawarto≈õƒá -->
        <div class="main-content">
            <div id="homeContent" class="content active">
                <h1>Archiwum</h1>
                
                <!-- Formularz wyszukiwania -->
                <form id="search-form">
                    <div class="form-group-inline">
                        <!-- Pierwszy rzƒÖd -->
                        <div class="form-group">
                            <label for="search-ubezpieczajacy">UbezpieczajƒÖcy:</label>
                            <input type="text" id="search-ubezpieczajacy" name="search-ubezpieczajacy">
                        </div>
                        <div class="form-group">
                            <label for="search-ubezpieczony">Ubezpieczony:</label>
                            <input type="text" id="search-ubezpieczony" name="search-ubezpieczony">
                        </div>
                        <div class="form-group">
                            <label for="search-przedmiot">Przedmiot:</label>
                            <input type="text" id="search-przedmiot" name="search-przedmiot">
                        </div>
                        <div class="form-group">
                            <label for="search-data-zawarcia-od">Data Zawarcia (od):</label>
                            <input type="date" id="search-data-zawarcia-od" name="search-data-zawarcia-od">
                        </div>
                        <div class="form-group">
                            <label for="search-ochrona-od">Roz. Ochrony (od):</label>
                            <input type="date" id="search-ochrona-od" name="search-ochrona-od">
                        </div>
                        <div class="form-group">
                            <label for="search-zakonczenie-od">Zak. Ochrony (od):</label>
                            <input type="date" id="search-zakonczenie-od" name="search-zakonczenie-od">
                        </div>
                    </div>
                    <div class="form-group-inline">
                        <!-- Drugi rzƒÖd -->
                        <div class="form-group">
                            <label for="search-numer-polisy">Numer Polisy:</label>
                            <input type="text" id="search-numer-polisy" name="search-numer-polisy">
                        </div>
                        <div class="form-group">
                            <label for="search-nip">NIP:</label>
                            <input type="text" id="search-nip" name="search-nip">
                        </div>
                        <div class="form-group">
                            <label for="search-regon">REGON:</label>
                            <input type="text" id="search-regon" name="search-regon">
                        </div>
                        <div class="form-group">
                            <label for="search-data-zawarcia-do">Data Zawarcia (do):</label>
                            <input type="date" id="search-data-zawarcia-do" name="search-data-zawarcia-do">
                        </div>
                        <div class="form-group">
                            <label for="search-ochrona-do">Roz. Ochrony (do):</label>
                            <input type="date" id="search-ochrona-do" name="search-ochrona-do">
                        </div>
                        <div class="form-group">
                            <label for="search-zakonczenie-do">Zak. Ochrony (do):</label>
                            <input type="date" id="search-zakonczenie-do" name="search-zakonczenie-do">
                        </div>
                    </div>
                    <div class="form-group">
                        <button type="submit" class="search-button">Szukaj</button>
                    </div>
                </form>

                <!-- Tabela wynik√≥w wyszukiwania -->
                <div id="wyniki-wyszukiwania" style="display: none;">
                    <table id="lista-wynikow">
                        <thead>
                            <tr>
                                <th>Numer Polisy</th>
                                <th>UbezpieczajƒÖcy</th>
                                <th>Przedmiot Ubezpieczenia</th>
                                <th>Data Zawarcia</th>
                                <th>Data Zako≈Ñczenia</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Wiersze tabeli bƒôdƒÖ dodawane dynamicznie przez JavaScript -->
                        </tbody>
                    </table>
                    <div class="button-container">
                        <button id="show-more-button" style="display: none;">Poka≈º wiƒôcej</button>
                        <button id="generate-report-button" style="display: none;">Wygeneruj zestawienie</button>
                    </div>
                </div>

                <div id="pierwsze-pozycje">
                    <table id="lista-pierwszych-pozycji">
                        <thead>
                            <tr>
                                <th>Numer Polisy</th>
                                <th>UbezpieczajƒÖcy</th>
                                <th>Przedmiot Ubezpieczenia</th>
                                <th>Data Zawarcia</th>
                                <th>Data Zako≈Ñczenia</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Wiersze tabeli bƒôdƒÖ dodawane dynamicznie przez JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="addDocumentContent" class="content">
                <h1>Nowa Polisa</h1>
                <form id="document-form">
                    <div class="form-group">
                        <label for="rodzaj">Rodzaj:</label>
                        <select id="rodzaj" name="rodzaj" required>
                            <option value="Komunikacyjna">Komunikacyjna</option>
                            <option value="MajƒÖtkowa">MajƒÖtkowa</option>
                            <option value="≈ªyciowa">≈ªyciowa</option>
                            <option value="Nale≈ºno≈õci">Nale≈ºno≈õci</option>
                            <option value="Inne">Inne</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="typ">Typ:</label>
                        <select id="typ" name="typ" required>
                            <option value="Polisa">Polisa</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="opiekun">Opiekunowie:</label>
                        <select id="opiekun" name="opiekun" required>
                            <option value="Alicja Tokarczyk">Alicja Tokarczyk</option>
                            <option value="Sabina Belina">Sabina Belina</option>
                            <option value="Katarzyna Kami≈Ñska">Katarzyna Kami≈Ñska</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Rodzaj ubezpieczajƒÖcego:</label>
                        <input type="radio" id="osoba_prywatna" name="rodzaj_ubezpieczajacego" value="osoba_prywatna">
                        <label for="osoba_prywatna">Osoba prywatna</label>
                        <input type="radio" id="firma" name="rodzaj_ubezpieczajacego" value="firma">
                        <label for="firma">Firma</label>
                    </div>

                    <div class="inline-group" id="nip_regon_group" style="display: none;">
                        <div class="form-group">
                            <label for="nip">NIP:</label>
                            <div style="display: flex; align-items: center;">
                                <input type="text" id="nip" name="nip">
                                <button type="button" id="search-nip-button" style="margin-left: 5px;">üîç</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="regon">REGON:</label>
                            <div style="display: flex; align-items: center;">
                                <input type="text" id="regon" name="regon">
                                <button type="button" id="search-regon-button" style="margin-left: 5px;">üîç</button>
                            </div>
                        </div>
                    </div>

                    <div id="ubezpieczajacy_group" style="display: none;">
                        <div class="form-group">
                            <label for="ubezpieczajacy">UbezpieczajƒÖcy:</label>
                            <input type="text" id="ubezpieczajacy" name="ubezpieczajacy" required>
                        </div>

                        <div class="form-group inline-group">
                            <div class="form-group">
                                <label for="numer_ubezpieczenia">Numer polisy:</label>
                                <input type="text" id="numer_ubezpieczenia" name="numer_ubezpieczenia" required>
                            </div>
                            <div class="form-group">
                                <label for="towarzystwo">Nazwa Towarzystwa Ubezpieczeniowego:</label>
                                <select id="towarzystwo" name="towarzystwo" required>
                                    <option value="Allianz">Towarzystwo Ubezpiecze≈Ñ i Reasekuracji Allianz Polska S.A.</option>
                                    <option value="Uniqa">UNIQA Towarzystwo Ubezpiecze≈Ñ S.A.</option>
                                    <option value="Generali">Generali Towarzystwo Ubezpiecze≈Ñ S.A.</option>
                                    <option value="InterRisk">InterRisk Towarzystwo Ubezpiecze≈Ñ S.A. Vienna Insurance Group</option>
                                    <option value="PZU">Powszechny Zak≈Çad Ubezpiecze≈Ñ S.A.</option>
                                    <option value="Warta">Towarzystwo Ubezpiecze≈Ñ i Reasekuracji "WARTA" S.A.</option>
                                    <option value="Hestia">Sopockie Towarzystwo Ubezpiecze≈Ñ Ergo Hestia SA</option>
                                    <option value="Wiener">WIENER TU S.A. Vienna Insurance Group</option>
                                    <option value="Compensa">Compensa TU S.A. Vienna Insurance Group</option>
                                    <option value="Leadenhall">Leadenhall Polska S.A.</option>
                                    <option value="AXA">AXA Ubezpieczenia Towarzystwo Ubezpiecze≈Ñ i Reasekuracji S.A.</option>
                                    <option value="Allianz ≈ªycie">Towarzystwo Ubezpiecze≈Ñ Allianz ≈ªycie Polska S.A.</option>
                                    <option value="Zdrowie">Towarzystwo Ubezpiecze≈Ñ ZDROWIE S.A.</option>
                                    <option value="Inter">Towarzystwo Ubezpiecze≈Ñ INTER Polska S.A.</option>
                                    <option value="TUZ">TUZ Towarzystwo Ubezpiecze≈Ñ Wzajemnych</option>
                                    <option value="AXA ≈ªycie">AXA ≈ªycie Towarzystwo Ubezpiecze≈Ñ S.A.</option>
                                    <option value="PZU ≈ªycie">Powszechny Zak≈Çad Ubezpiecze≈Ñ na ≈ªycie S.A.</option>
                                    <option value="Findia">Findia Sp. z o.o.</option>
                                    <option value="Unum">Unum ≈ªycie Towarzystwo Ubezpiecze≈Ñ i Reasekuracji S. A.</option>
                                    <option value="Uniqa ≈ªycie">Uniqa Towarzystwo Ubezpiecze≈Ñ na ≈ªycie S. A.</option>
                                    <option value="LuxMed">Lux Med Sp. z o.o.</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group inline-group">
                            <div class="form-group">
                                <label for="przedmiot_ubezpieczenia">Przedmiot ubezpieczenia:</label>
                                <input type="text" id="przedmiot_ubezpieczenia" name="przedmiot_ubezpieczenia" required>
                            </div>
                            <div class="form-group">
                                <label for="skladka">Kwota sk≈Çadki:</label>
                                <input type="text" id="skladka" name="skladka" required>
                            </div>
                        </div>

                        <div id="ubezpieczony_group" style="display: none;">
                            <div class="form-group">
                                <label for="ubezpieczony">Ubezpieczony:</label>
                                <input type="text" id="ubezpieczony" name="ubezpieczony" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="data_zawarcia">Data zawarcia:</label>
                            <input type="date" id="data_zawarcia" name="data_zawarcia" required>
                        </div>

                        <div class="form-group">
                            <label for="ochrona_od">Data rozpoczƒôcia:</label>
                            <input type="date" id="ochrona_od" name="ochrona_od" required>
                        </div>

                        <div class="form-group">
                            <label for="ochrona_do">Data zako≈Ñczenia:</label>
                            <input type="date" id="ochrona_do" name="ochrona_do" required>
                        </div>

                        <div class="form-group">
                            <button type="submit" id="submit-document-button" style="display: none;">Dodaj dokument</button>
                        </div>
                    </div>
                </form>
                <div id="response"></div>
            </div>

            <div id="addPaymentContent" class="content">
                <h1>Nowa P≈Çatno≈õƒá</h1>
                <form id="payment-form">
                    <div class="form-group">
                        <label for="search-numer-polisy-payment">Numer Polisy:</label>
                        <input type="text" id="search-numer-polisy-payment" name="search-numer-polisy-payment" class="small-input centered-input">
                    </div>
                    <div class="form-group">
                        <button type="submit" id="search-payment-button" class="search-button">Szukaj</button>
                    </div>
                </form>
                <div id="paymentResponse"></div>
            </div>

            <div id="panelPolisy" class="content" style="display: none;">
                <h1 id="panelPolisyTitle"></h1>
                <div id="formContainer"></div>
                <div id="ratContainer">
                    <label for="liczbaRat">Podaj liczbƒô rat:</label>
                    <input type="number" id="liczbaRat" min="1" />
                    <label for="kurtaz">Podaj kurta≈º:</label>
                    <input type="number" id="kurtazProcent" min="0.01" step="0.01" value="0.01" />
                    <button onclick="generujTabeleRat()">OK</button>
                </div>
                <div id="tableContainer"></div>
                <button id="savePaymentsButton" style="display: none;" onclick="zapiszPlatnosci()">Zapisz p≈Çatno≈õci</button>
            </div>

            <div id="documentInfoContent" class="content" style="display: none;">
                <h1>Dane polisy</h1>
                <form id="policy-search-form" class="centered-form">
                    <div class="form-group">
                        <label for="policy-number">Numer Polisy:</label>
                        <input type="text" id="policy-number" name="policy-number" class="small-input centered-input">
                    </div>
                    <div class="form-group search-form-group">
                        <button type="submit" class="search-button large-button">Szukaj</button>
                    </div>
                </form>
                <div id="policy-details-container" style="margin-top: 20px;">
                    <!-- Tabela wynik√≥w zostanie wygenerowana dynamicznie -->
                </div>
            </div>

            <div id="reportKNFContent" class="content" style="display: none;">
                <h1>Generowanie Raportu KNF</h1>
                <form id="reportKNF-form" class="centered-form">
                    <div class="inline-group">
                        <div class="form-group">
                            <label for="reportKNF-data-zawarcia-od">Data Zawarcia (od):</label>
                            <input type="date" id="reportKNF-data-zawarcia-od" name="reportKNF-data-zawarcia-od" class="centered-input">
                        </div>
                        <div class="form-group">
                            <label for="reportKNF-data-zawarcia-do">Data Zawarcia (do):</label>
                            <input type="date" id="reportKNF-data-zawarcia-do" name="reportKNF-data-zawarcia-do" class="centered-input">
                        </div>
                    </div>
                    <div class="form-group search-form-group">
                        <button type="submit" class="search-button large-button">Generuj Raport</button>
                    </div>
                </form>
            </div>

        </div>
    </div>
    <script>
        window.addEventListener("beforeunload", async (event) => {
            try {
                await fetch("http://127.0.0.1:8000/shutdown", { method: "GET" });
            } catch (error) {
                console.error("B≈ÇƒÖd podczas zamykania serwera:", error);
            }
        });
    </script>
    <script src="/static/js/script.js?v=1.0"></script>
</body>
</html>